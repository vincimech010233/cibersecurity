import os

# Generar clave secreta fija
SECRET_KEY = os.urandom(16)

def sign(message):
    """Firma un mensaje usando XOR con la clave secreta."""
    return bytes([m ^ k for m, k in zip(message, SECRET_KEY)])

def verify(message, signature):
    """Verifica si el mensaje corresponde a la firma."""
    return sign(message) == signature

if __name__ == "__main__":
    # Ejemplo de mensaje
    message = b"HTB{example_message}"
    signature = sign(message)

    print(f"Mensaje: {message}")
    print(f"Firma (hex): {signature.hex()}")
