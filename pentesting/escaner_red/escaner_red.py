import socket
import ipaddress

def escanear_red(rango_red):
    """
    Escanea un rango de red para encontrar hosts activos en el puerto 80.
    """
    red = ipaddress.ip_network(rango_red, strict=False)
    hosts_activos = []

    for ip in red.hosts():
        with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
            s.settimeout(0.5)
            # Intentar conectar al puerto 80 (HTTP)
            resultado = s.connect_ex((str(ip), 80))
            if resultado == 0:
                hosts_activos.append(str(ip))

    return hosts_activos

if __name__ == "__main__":
    rango = input("Introduce el rango de IP a escanear (formato CIDR, e.g., 192.168.1.0/24): ")
    print("Escaneando la red...")
    dispositivos = escanear_red(rango)
    if dispositivos:
        print("Hosts activos encontrados:")
        for dispositivo in dispositivos:
            print(f"- {dispositivo}")
    else:
        print("No se encontraron hosts activos en el rango especificado.")
